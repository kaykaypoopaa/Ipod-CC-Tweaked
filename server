-- CC: Tweaked WebSocket Server
print("Starting CC WebSocket Server...")

local ws, err = http.websocket("ws://127.0.0.1:8765")

if not ws then
    error("Failed to connect: " .. tostring(err))
end

print("Connected to bridge server!")
print("Waiting for requests...")

-- Your website content/logic
local function handleRequest(path)
    if path == "/" or path == "" then
        return [[
<!DOCTYPE html>
<html>
<head>
    <title>CC: Tweaked Server</title>
    <style>
        body { 
            font-family: 'Courier New', monospace; 
            max-width: 800px; 
            margin: 50px auto;
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
        }
        h1 { color: #00ff00; text-shadow: 0 0 10px #00ff00; }
        a { color: #00ccff; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .terminal { 
            background: #000; 
            padding: 15px; 
            border: 2px solid #00ff00;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="terminal">
        <h1>‚ö° CC: Tweaked Web Server ‚ö°</h1>
        <p>This website is being served from inside Minecraft!</p>
        <p>Running on Computer #]] .. os.getComputerID() .. [[</p>
        <ul>
            <li><a href="/about">About This Server</a></li>
            <li><a href="/time">Minecraft Time</a></li>
            <li><a href="/status">Computer Status</a></li>
            <li><a href="/counter">Visitor Counter</a></li>
        </ul>
    </div>
</body>
</html>
        ]]
    
    elseif path == "/about" then
        return [[
<!DOCTYPE html>
<html>
<head>
    <title>About</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 50px auto; }
    </style>
</head>
<body>
    <h1>About This Server</h1>
    <p>This is a web server where:</p>
    <ul>
        <li>The content is generated by a ComputerCraft computer IN Minecraft</li>
        <li>Requests go through a WebSocket bridge</li>
        <li>All the HTML is created by Lua code</li>
    </ul>
    <p><a href="/">‚Üê Back to Home</a></p>
</body>
</html>
        ]]
    
    elseif path == "/time" then
        local time = os.time()
        local day = os.day()
        return string.format([[
<!DOCTYPE html>
<html>
<head><title>Minecraft Time</title></head>
<body style="font-family: Arial; max-width: 800px; margin: 50px auto;">
    <h1>‚è∞ Minecraft Time</h1>
    <p><strong>Day:</strong> %d</p>
    <p><strong>Time:</strong> %.2f</p>
    <p><strong>Formatted:</strong> %s</p>
    <p><a href="/">‚Üê Back to Home</a></p>
</body>
</html>
        ]], day, time, textutils.formatTime(time, false))
    
    elseif path == "/status" then
        local label = os.getComputerLabel() or "Unlabeled Computer"
        local id = os.getComputerID()
        return string.format([[
<!DOCTYPE html>
<html>
<head><title>Computer Status</title></head>
<body style="font-family: Arial; max-width: 800px; margin: 50px auto;">
    <h1>üíª Computer Status</h1>
    <p><strong>Computer ID:</strong> %d</p>
    <p><strong>Label:</strong> %s</p>
    <p><strong>Fuel Level:</strong> %s</p>
    <p><a href="/">‚Üê Back to Home</a></p>
</body>
</html>
        ]], id, label, turtle and turtle.getFuelLevel() or "N/A (not a turtle)")
    
    elseif path == "/counter" then
        -- Persistent counter using a file
        local count = 0
        if fs.exists("visitor_count") then
            l
